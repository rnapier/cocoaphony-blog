
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>Cocoaphony</title>
  <meta name="author" content="Rob Napier">

  
  <meta name="description" content="Now that we’re past the New Year, and I have a chance to reorganize my schedule, I’m working up my next series of postings. While you’re all &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="https://robnapier.net/page9">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="Cocoaphony" type="application/atom+xml">
  <link href="https://micro.blog/cocoaphony" rel="me" />
  <link href="https://twitter.com/cocoaphony" rel="me" />
  <!-- <script src="/javascripts/modernizr-2.0.js"></script> -->
  <!-- <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> -->
  <!-- <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/libs/jquery.min.js"%3E%3C/script%3E'))</script> -->
  <!-- <script src="/javascripts/octopress.js" type="text/javascript"></script> -->
  
</head>

<body    class="collapse-sidebar sidebar-footer" >
  <header role="banner"><hgroup>
  <h1><a href="/">Cocoaphony</a></h1>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>

<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/archives">Archives</a></li>
  <li><a href="/talks">Talks</a></li>
  <li><a href="https://cocoaphony.micro.blog">micro.blog</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/gotoandplay">gotoAndPlay</a></h1>
    
    
      <p class="meta">
        








<time datetime="2010-01-08T10:45:43-05:00" pubdate data-updated="true">08 Jan 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Now that we’re past the New Year, and I have a chance to reorganize my schedule, I’m working up my next series of postings. While you’re all patiently waiting, go read <a href="http://gotoandplay.freeblog.hu">gotoAndPlay</a>. I started out helping Geri on some <a href="http://stackoverflow.com/questions/2016394/set-opacity-of-a-cglayer-before-draw">layer</a> drawing <a href="http://stackoverflow.com/questions/2024376/drawing-a-cglayer-outside-the-method-drawrect-faster/2024421">questions</a> on StackOverflow, and have really gotten interested in his efforts to make his apps really beautiful.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/recent-pandora-update">The Recent Pandora Update</a></h1>
    
    
      <p class="meta">
        








<time datetime="2009-12-25T17:24:06-05:00" pubdate data-updated="true">25 Dec 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>PandoraBoy’s user interface is pretty screwed up since the recent Pandora update. I’ve talked with Pandora and it’s a known problem with WebKit. You’ll see the same issues if you run Safari. Pandora is working on a fix, and when they deploy it, PandoraBoy should automatically work again.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/pandoraboy-08">PandoraBoy 0.8</a></h1>
    
    
      <p class="meta">
        








<time datetime="2009-09-28T22:26:34-04:00" pubdate data-updated="true">28 Sep 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I’ve put out <a href="http://code.google.com/p/pandoraboy/">PB 0.8</a>. It has a small number of preference and hotkey fixes, upgrades to the latest ShortcutRecorder (which took a lot more work than I hoped, and I still think may be a little flakey), dropped 10.4 support (because of the latest ShortcutRecorder), and adds experimental <a href="http://rowmote.com/Rowmote/Rowmote.html">Rowmote</a> support. (I may accidentally list “rowmote” as “rowmate” in the changelog; sorry about that.) I say “experimental” because I haven’t gotten around to testing it myself. The author of Rowmote kindly provided me a patch, and I’ve applied it and nothing seems to have blown up.</p>

<p>I’m planning at least another day of PB work this week, so vote on the Issues list for things you most care about and I’ll hit those first. Testing 10.6 support is obviously top of the charts. My main production box is still 10.5, and that’s where I run PB, so I haven’t actually run into the problem yet. But I have 10.6 boxes around to test with.</p>

<p>I know there are a lot of significant bumps with PB these days. I focus almost all of my development time on my full time Mac and iPhone projects, and only look at PB now and then (since it does everything I really want it to). But later this week I’ll make some more time to take care of the bigger issues that impact folks the most. Pandora is still my favorite music service, and I spend a lot of time listening to it. I like to help others enjoy it as much as I do.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/gcd-iphone-long-batter">GCD + iPhone</a></h1>
    
    
      <p class="meta">
        








<time datetime="2009-09-14T09:14:51-04:00" pubdate data-updated="true">14 Sep 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://blogs.yankeegroup.com/2009/08/26/the-long-lasting-power-of-snow-leopard/">The long-lasting power of Snow Leopard</a> from The Yankee Group.</p>

<p>Ever since I first saw GCD at WWDC, I’ve been amazed by it and eager to give it a real spin. But since the vast majority of my work is in low-level libraries that run on both Mac and iPhone, GCD is closed to me (as is garbage collection; more on that later). I’ve said that multi-core would come to mobile devices because everything will come to mobile devices (laptops are the new desktops, and mobile is the new laptop). And for the iPhone, multi-core also makes a lot of sense by allowing Apple to dedicate a core to its own use during important functions like phone calls. But Carl Howe makes an even more compelling argument for mobile multi-core: better battery life.</p>

<p>With multi-core comes another strong possibility: garbage collection. The availability of a second core makes this more likely on iPhone. Yes, memory is tighter, but ever-growing. And GC will likely do a better job of reclaiming memory faster than much of the leaky programs I see from novice programmers. But to do it well, I think a second core is a real must. I’ve grown good at memory management over the years, and it’s hard for me to write GC Cocoa because it “feels wrong.” But I think I could get used to it…. And it would help alleviate the biggest class of coding error I see in Cocoa programs.</p>

<p>Of course, the clang static analyzer will probably help get rid of 90% of those errors anyway, so maybe the need for GC just went way down…. Have I mentioned recently how incredible clang really is? I desperately long for them to finish bringing it to Obj-C++ so I can use it.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/implementing-nscopying">Implementing NSCopying (or NSCopyObject() Considered Harmful)</a></h1>
    
    
      <p class="meta">
        








<time datetime="2009-09-04T17:24:05-04:00" pubdate data-updated="true">04 Sep 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><code class="language-plaintext highlighter-rouge">NSCopying</code> is not always as simple to implement as you would think. Apple has a good <a href="http://developer.apple.com/mac/library/documentation/Cocoa/Conceptual/MemoryMgmt/Articles/mmImplementCopy.html">write-up</a> discussing the complexities, but let me elaborate. Forgive some ranting digressions. It’s important to know how to work around the problems I’m going to discuss, but it’s also important to understand how insane it is to have to work around this issue.</p>

<p>First, there’s the fairly obvious problem of deep versus shallow copies. If object <code class="language-plaintext highlighter-rouge">foo</code> has an instance variable <code class="language-plaintext highlighter-rouge">*bar</code>, should a copy of <code class="language-plaintext highlighter-rouge">foo</code> have a second pointer to <code class="language-plaintext highlighter-rouge">bar</code>, or should it have its own copy of whatever <code class="language-plaintext highlighter-rouge">bar</code> points to? There is no way to answer this question generally; it depends on the nature of the objects.</p>

<p>Most of the time, this can be dealt with fairly easily by implementing the accessors with the correct behavior (retain versus copy), and you wind up with a <code class="language-plaintext highlighter-rouge">copyWithZone:</code> like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- (id)copyWithZone:(NSZone *)zone
{
    Product *copy = [[[self class] allocWithZone: zone] init];
    [copy setProductName:[self productName]];
    return copy;
}
</code></pre></div></div>

<p>That works really well as long as your superclass doesn’t implement <code class="language-plaintext highlighter-rouge">NSCopying</code>, but if it does, you may not have enough information or access to cleanly copy it. Now you would think this would be easy:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>- (id)copyWithZone:(NSZone *)zone
{
    Product *copy = [super copy];
    [copy setProductName:[self productName]];
    return copy;
}
</code></pre></div></div>

<p>But that may or may not work. If <code class="language-plaintext highlighter-rouge">super</code> implements <code class="language-plaintext highlighter-rouge">-copyWithZone:</code> as described above, then all is fine. But what if your superclass uses <code class="language-plaintext highlighter-rouge">NSCopyObject()</code>? Things go badly, and in ways very difficult to understand and debug. </div>
  
  
    <footer>
      <a rel="full-article" href="/implementing-nscopying">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/importing-uikit-cocoa">Importing UIKit vs. Cocoa</a></h1>
    
    
      <p class="meta">
        








<time datetime="2009-08-20T11:28:40-04:00" pubdate data-updated="true">20 Aug 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I work on a lot of projects that share significant code between iPhone and Mac versions. This is the beauty of Cocoa. While working on these projects, I’ve bumped into this idiom many times:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>#ifdef TARGET_OS_IPHONE
#import &lt;UIKit/UIKit.h&gt;
#else
#import &lt;Cocoa/Cocoa.h&gt;
#endif
</code></pre></div></div>

<p>This is almost never correct, and almost always means that someone imported Cocoa.h into a model class. Model classes should never rely on UIKit or Cocoa. They should just import Foundation.h.</p>

<p>There is one interesting exception that we’ve run into: NSImage versus UIImage. These are really model classes, but they’re part of AppKit and UIKit. They have very similar interfaces, so in most code you should be able to interchange them and keep everything portable. What to do?
</div>
  
  
    <footer>
      <a rel="full-article" href="/importing-uikit-cocoa">Read on &rarr;</a>
    </footer>
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/regrowling-song">Re-growling Song in PB</a></h1>
    
    
      <p class="meta">
        








<time datetime="2009-08-19T09:01:02-04:00" pubdate data-updated="true">19 Aug 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I started implementing a hotkey to regrowl the current song. ishermandom sent me a patch months ago to do this, and I’ve just started integrating it. It’s very small, I just hadn’t done it yet. Since I’ve restructured hotkeys due to the ShortcutRecorder upgrade, I’ve actually had to reimplement it anyway, but really, it’s not complicated.</p>

<p>I also pulled some of the NSLog() statements out, so PB will no longer fill your Console with messages about what song is playing. If you want need this functionality for something, let me know. There are better ways for me to implement it.</p>

<p>Funny, Pandora seems down this morning? The silence is deafening. Even while I’m investigating why the flash player isn’t coming up (even in Safari), I keep hitting my “play” shortcut because its too quiet. I guess I pull out iTunes….</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/pandoraboy-moving-leopard">PandoraBoy Moving to Leopard</a></h1>
    
    
      <p class="meta">
        








<time datetime="2009-08-18T09:16:18-04:00" pubdate data-updated="true">18 Aug 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>For the last couple of nights I’ve finally gotten back to PandoraBoy work. The backlog of issues has gotten a bit out of hand as I’ve focused on other projects. One thing that has hung me up for a while has been the Hotkey preferences pane, which uses ShortcutRecorder. SR had an IB Pallet that only worked with IB2.5, not IB3, which made working on that panel very difficult. I’ve finally upgraded SR to the latest version, which required a lot of recoding since PB relied SR’s now-deprecated autosave functionality.</p>

<p>The side effect of all of that is that the latest SR requires Leopard, and so now PB requires Leopard. I had planned to wait for SnowLeopard’s release to drop Tiger support, but this accelerates that a bit. It does make my coding a work a bit easier, since 10.5 has many nice developer features.</p>

<p>Drop me a note if you’re still running PB on Tiger. Every other major user of ShortcutRecorder had already gone Leopard-only, which is why they made the move. Tigers are getting pretty rare out there.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/flash-bug-sigint-debugger">Flash Bug, SIGINT From Debugger()</a></h1>
    
    
      <p class="meta">
        








<time datetime="2009-08-16T21:17:14-04:00" pubdate data-updated="true">16 Aug 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>Thank you <a href="http://www.stinkbot.com/blog/archives/69">stinkblog</a>, thank you for saving me a great deal of pain debugging this. PandoraBoy work can now continue.</p>
</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/quit-stringwithstring">Quit Using +stringWithString:</a></h1>
    
    
      <p class="meta">
        








<time datetime="2009-08-12T10:48:10-04:00" pubdate data-updated="true">12 Aug 2009</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p>I keep coming across <a href="http://dotnetaddict.dotnetdevelopersjournal.com/leopard_nscollectionview.htm">code</a> like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>newMonster.trueName = [NSString stringWithString:@"New Monster"];
</code></pre></div></div>

<p>It’s time to say stop it already with the extra <code class="language-plaintext highlighter-rouge">+stringWithString:</code>. I haven’t worked out yet where this anti-pattern comes from. Maybe it’s a misunderstanding of some sample code in <a href="http://www.amazon.com/Programming-Objective-C-Developers-Library-Stephen/dp/0672325861">Kochan</a>? Maybe it’s a Java/.NET thing? I’m not sure. But I see it so often from so many places that it’s clearly something that needs discussing. (The rest of the linked article is good; it just gave me a good example of this issue.)</p>

</div>
  
  
    <footer>
      <a rel="full-article" href="/quit-stringwithstring">Read on &rarr;</a>
    </footer>
  


    </article>
  
  <div class="pagination">
    
      <a class="prev" href="/page10">&larr; Older</a>
    
    <a href="/archives">Blog Archives</a>
    
    <a class="next" href="/page8">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    
  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2024 - <a href="mailto:rob@neverwood.org">Rob Napier</a> - <a href="https://twitter.com/cocoaphony">@cocoaphony</a> - 
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  









<!-- Fathom - simple website analytics - https://usefathom.com -->
<script>
(function(f, a, t, h, o, m){
a[h]=a[h]||function(){
    (a[h].q=a[h].q||[]).push(arguments)
};
o=f.createElement('script'),
m=f.getElementsByTagName('script')[0];
o.async=1; o.src=t; o.id='fathom-script';
m.parentNode.insertBefore(o,m)
})(document, window, '//cdn.usefathom.com/tracker.js', 'fathom');
fathom('set', 'siteId', 'MSRAZWIU');
fathom('trackPageview');
</script>
<!-- / Fathom -->




</body>
</html>
